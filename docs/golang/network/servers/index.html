<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.109.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Servers | Goldydocs</title><meta name=description content="Working with Servers in Go.
"><meta property="og:title" content="Servers"><meta property="og:description" content="Working with Servers in Go.
"><meta property="og:type" content="article"><meta property="og:url" content="/docs/golang/network/servers/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-07-28T00:38:53-04:00"><meta property="og:site_name" content="Goldydocs"><meta itemprop=name content="Servers"><meta itemprop=description content="Working with Servers in Go.
"><meta itemprop=dateModified content="2023-07-28T00:38:53-04:00"><meta itemprop=wordCount content="4206"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Servers"><meta name=twitter:description content="Working with Servers in Go.
"><link rel=preload href=/scss/main.min.d6cc2ae862fa5c937a2dbb3d86c775f5e0f56868c19e280b817554aeceea0342.css as=style><link href=/scss/main.min.d6cc2ae862fa5c937a2dbb3d86c775f5e0f56868c19e280b817554aeceea0342.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=navbar-brand__name>Goldydocs</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/><span class=active>Documentation</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/no/>Norsk</a>
<a class=dropdown-item href=/fa/>فارسی</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/no/>Norsk</a>
<a class=dropdown-item href=/fa/>فارسی</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsbash-li><a href=/docs/bash/ title="Bash scripting" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsbash><span>Bash</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsbashblueprints-li><a href=/docs/bash/blueprints/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbashblueprints><span>Blueprints</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsbashcommands-li><a href=/docs/bash/commands/ title="Common commands" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbashcommands><span>Commands</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsbashbasics-li><a href=/docs/bash/basics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbashbasics><span>Basics</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsbashsnippets-li><a href=/docs/bash/snippets/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsbashsnippets><span>Snippets</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docscss-li><a href=/docs/css/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docscss><span>CSS Styling</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssrepodump-li><a href=/docs/css/repodump/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssrepodump><span>Repo dump</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssbox-model-li><a href=/docs/css/box-model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssbox-model><span>Box model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssflex-li><a href=/docs/css/flex/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssflex><span>Flexbox</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssgrid-li><a href=/docs/css/grid/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssgrid><span>Grid</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscsspositioning-li><a href=/docs/css/positioning/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscsspositioning><span>Positioning</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssselectors-li><a href=/docs/css/selectors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssselectors><span>Selectors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssrelative-units-li><a href=/docs/css/relative-units/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssrelative-units><span>Relative Units</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssnav-example-li><a href=/docs/css/nav-example/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssnav-example><span>Navigation example</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docscssexample-li><a href=/docs/css/example/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docscssexample><span>Sample styling sheet</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsddd-li><a href=/docs/ddd/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsddd><span>Domain-driven design</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdddentities-li><a href=/docs/ddd/entities/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsdddentities><span>Entities</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdddvalue-objects-li><a href=/docs/ddd/value-objects/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsdddvalue-objects><span>Value objects</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdddaggregates-li><a href=/docs/ddd/aggregates/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsdddaggregates><span>Aggregates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsdddservices-li><a href=/docs/ddd/services/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsdddservices><span>Services</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgit-li><a href=/docs/git/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgit><span>git</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgithub-li><a href=/docs/github/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgithub><span>GitHub</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgithubgh-actions-li><a href=/docs/github/gh-actions/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgithubgh-actions><span>GitHub actions</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docsgolang-li><a href=/docs/golang/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolang><span>Golang</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgolangoverhead-li><a href=/docs/golang/overhead/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolangoverhead><span>Project organization</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangoverheadproject-setup-li><a href=/docs/golang/overhead/project-setup/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangoverheadproject-setup><span>Project setup</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangoverheadtooling-li><a href=/docs/golang/overhead/tooling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangoverheadtooling><span>Go tooling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangoverheadidioms-li><a href=/docs/golang/overhead/idioms/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangoverheadidioms><span>Idioms</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangoverheadblueprints-li><a href=/docs/golang/overhead/blueprints/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangoverheadblueprints><span>Blueprints</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgolangbasics-li><a href=/docs/golang/basics/ title="Getting started with Go" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolangbasics><span>Getting started</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangbasicserrors-li><a href=/docs/golang/basics/errors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangbasicserrors><span>Errors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangbasicstypes-li><a href=/docs/golang/basics/types/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangbasicstypes><span>Types and collections</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgolangio-li><a href=/docs/golang/io/ title="Input and output" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolangio><span>I/O</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangiojson-li><a href=/docs/golang/io/json/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangiojson><span>JSON data</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangiorw-files-li><a href=/docs/golang/io/rw-files/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangiorw-files><span>Reading, writing, files</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docsgolangnetwork-li><a href=/docs/golang/network/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolangnetwork><span>Network</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangnetworkclients-li><a href=/docs/golang/network/clients/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangnetworkclients><span>Clients</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docsgolangnetworkservers-li><a href=/docs/golang/network/servers/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docsgolangnetworkservers><span class=td-sidebar-nav-active-item>Servers</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsgolangdatabases-li><a href=/docs/golang/databases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsgolangdatabases><span>Databases</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasespatterns-li><a href=/docs/golang/databases/patterns/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasespatterns><span>Patterns</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasessql-package-li><a href=/docs/golang/databases/sql-package/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasessql-package><span>SQL package</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasesmysql-li><a href=/docs/golang/databases/mysql/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasesmysql><span>MySQL</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasespostgres-li><a href=/docs/golang/databases/postgres/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasespostgres><span>PostgreSQL</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasessqlite-li><a href=/docs/golang/databases/sqlite/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasessqlite><span>SQLite</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsgolangdatabasesmigrations-li><a href=/docs/golang/databases/migrations/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabasesmigrations><span>Migrations</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangtesting-li><a href=/docs/golang/testing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangtesting><span>Testing</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangconcurrency-li><a href=/docs/golang/concurrency/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangconcurrency><span>Concurrency</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangcli-tools-li><a href=/docs/golang/cli-tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangcli-tools><span>CLI tools</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangobservability-li><a href=/docs/golang/observability/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangobservability><span>Observability</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangdatabases-li><a href=/docs/golang/databases/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangdatabases><span>Databases</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangcontainers-li><a href=/docs/golang/containers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangcontainers><span>Containers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangcontext-li><a href=/docs/golang/context/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangcontext><span>Context</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangtemplates-li><a href=/docs/golang/templates/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangtemplates><span>Templates</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolanglogging-li><a href=/docs/golang/logging/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolanglogging><span>Logging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangsecurity-li><a href=/docs/golang/security/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangsecurity><span>Security</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangapis-li><a href=/docs/golang/apis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangapis><span>APIs</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsgolangrepo-dump-li><a href=/docs/golang/repo-dump/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsgolangrepo-dump><span>Repo dump</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsinkscape-li><a href=/docs/inkscape/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsinkscape><span>Inkscape</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsinkscapebasics-li><a href=/docs/inkscape/basics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsinkscapebasics><span>Basics</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsinkscapemenus-li><a href=/docs/inkscape/menus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsinkscapemenus><span>Menus</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsinkscaperepo-dump-li><a href=/docs/inkscape/repo-dump/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsinkscaperepo-dump><span>Repo dump</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsjavascript-li><a href=/docs/javascript/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docsjavascript><span>Javascript</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptinstall-li><a href=/docs/javascript/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptinstall><span>Installation</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascripttypes-globals-li><a href=/docs/javascript/types-globals/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascripttypes-globals><span>Types and globals</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptarrays-li><a href=/docs/javascript/arrays/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptarrays><span>Arrays</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptobjects-classes-li><a href=/docs/javascript/objects-classes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptobjects-classes><span>Objects and Classes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptloops-logic-li><a href=/docs/javascript/loops-logic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptloops-logic><span>Loops and logic</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptfunctions-li><a href=/docs/javascript/functions/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptfunctions><span>Functions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptdom-li><a href=/docs/javascript/dom/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptdom><span>Document Object Model (DOM)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptevents-li><a href=/docs/javascript/events/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptevents><span>Events</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptintermediate-li><a href=/docs/javascript/intermediate/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptintermediate><span>Intermediate JS</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docsjavascriptconcurrency-li><a href=/docs/javascript/concurrency/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docsjavascriptconcurrency><span>Concurrency</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docslinux-li><a href=/docs/linux/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docslinux><span>Linux</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docslinuxcommand-reference-li><a href=/docs/linux/command-reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docslinuxcommand-reference><span>Linux commands</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docslinuxtmux-li><a href=/docs/linux/tmux/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docslinuxtmux><span>tmux</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docspython-li><a href=/docs/python/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docspython><span>Python</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docssql-li><a href=/docs/sql/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docssql><span>SQL</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docssqlmysql-li><a href=/docs/sql/mysql/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docssqlmysql><span>MySQL</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docssqlpostgres-li><a href=/docs/sql/postgres/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docssqlpostgres><span>Postgres</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-docssqlsql-li><a href=/docs/sql/sql/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docssqlsql><span>Repo dump</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#server-type>Server type</a></li><li><a href=#http-handlers>HTTP handlers</a><ul><li><a href=#handlers-as-methods>Handlers as methods</a></li></ul></li><li><a href=#requests>Requests</a><ul><li><a href=#url-query-strings>URL query strings</a></li></ul></li><li><a href=#responses>Responses</a><ul><li><a href=#headers>Headers</a></li><li><a href=#constants>Constants</a></li></ul></li><li><a href=#routers>Routers</a><ul><li><a href=#go-router>Go router</a></li><li><a href=#3rd-party-router>3rd-party router</a></li><li><a href=#placeholder-routers>Placeholder routers</a></li></ul></li><li><a href=#writing-a-basic-server>Writing a basic server</a><ul><li><a href=#directory-structure>Directory structure</a></li><li><a href=#define-the-custom-server-type>Define the custom Server type</a></li><li><a href=#create-the-main-method>Create the main method</a></li></ul></li><li><a href=#timeouts>Timeouts</a></li><li><a href=#static-files>Static files</a><ul><li><a href=#directory-listings>Directory listings</a></li></ul></li><li><a href=#middleware>Middleware</a><ul><li><a href=#positioning>Positioning</a></li><li><a href=#security-headers>Security headers</a></li><li><a href=#request-logging>Request logging</a></li><li><a href=#register-middleware>Register middleware</a></li><li><a href=#panics>Panics</a></li></ul></li><li><a href=#forms>Forms</a><ul><li><a href=#validation>Validation</a></li></ul></li><li><a href=#sessions>Sessions</a></li><li><a href=#shutdown-gracefully>Shutdown gracefully</a></li><li><a href=#existing-docs>Existing docs</a><ul><li><a href=#multiplexers>Multiplexers</a></li><li><a href=#router-functions>Router functions</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Documentation</a></li><li class=breadcrumb-item><a href=/docs/golang/>Golang</a></li><li class=breadcrumb-item><a href=/docs/golang/network/>Network</a></li><li class="breadcrumb-item active" aria-current=page><a href=/docs/golang/network/servers/ aria-disabled=true class="btn-link disabled">Servers</a></li></ol></nav><div class=td-content><h1>Servers</h1><div class=lead>Working with Servers in Go.</div><header class=article-meta></header><p>The <code>net/http</code> package provides the <code>ListenAndServer()</code> function that creates a default server. However, this function does not allow you to define timeouts to manage bad connections or server resources, so you should define custom server.</p><h2 id=server-type>Server type</h2><p>Create a custom server with the <a href=https://pkg.go.dev/net/http#Server><code>Server</code> type</a>. The <code>Server</code> type is a struct with the following fields:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Server</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Addr</span>              <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Handler</span>           <span style=color:#000>Handler</span>
</span></span><span style=display:flex><span>	<span style=color:#000>TLSConfig</span>         <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Config</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ReadTimeout</span>       <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ReadHeaderTimeout</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span>	<span style=color:#000>WriteTimeout</span>      <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span>	<span style=color:#000>IdleTimeout</span>       <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Duration</span>
</span></span><span style=display:flex><span>	<span style=color:#000>MaxHeaderBytes</span>    <span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span>	<span style=color:#000>TLSNextProto</span>      <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>tls</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ConnState</span>         <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ConnState</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ErrorLog</span>          <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Logger</span>
</span></span><span style=display:flex><span>	<span style=color:#000>BaseContext</span>       <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Listener</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ConnContext</span>       <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#000>net</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Conn</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=http-handlers>HTTP handlers</h2><p>Servers receive requests, dispatch those requests to the handler that is registered to the receiving path, and the handler sends a response. In Go, each incoming request is served in its own goroutine, which means each request is handled concurrently.</p><p>You create the server, then use <code>HandleFunc</code> to register routes to handler functions. Then you use <code>HandlerFunc</code> to define the handler function for the route.</p><ul><li><code>http.Handler</code> is an interface that has the <code>ServeHTTP(w ResponseWriter, r *Request)</code> signature.</li><li><code>http.HandlerFunc</code> is an adapter type that lets you define ordinary functions as HTTP handlers. It adds a <code>ServerHTTP(w, r)</code> method to whatever function you pass it.</li><li><code>http.HandleFunc</code> registers a handler with a multiplexer server. It is syntactic sugar&ndash;it transforms a function to a handler and registers it in one step. It accepts two arguments: the path as a <code>string</code>, and the handler function. It implements <code>ServeHTTP()</code>.</li><li><code>http.NewServeMux()</code> returns a custom server. It implements <code>ServeHTTP()</code>.</li></ul><p>The following example registers the <code>homeHandler</code> twice, but each method is functionally equivalent:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>homeHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// handler logic 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>homeHandler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandleFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>homeHandler</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=handlers-as-methods>Handlers as methods</h3><p>Create handlers and helpers as methods on the application struct. This allows the handlers to access any application dependencies, like loggers:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// main.go
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>application</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>log</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Logger</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// handlerName.go
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>handlerName</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#ce5c00;font-weight:700>...</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=requests>Requests</h2><h3 id=url-query-strings>URL query strings</h3><p>Sometimes requests pass information as key-value pairs in the URL:</p><pre tabindex=0><code>http://localhost:4000/snippet/view?id=123
</code></pre><p>The values after the <code>?</code> are <em>query strings</em>, and they take the form of <code>key</code>=<code>value</code>. You can access the <code>key</code> portion of the query string and retrieve the <code>value</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>URL</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Query</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>The proceeding example uses the <code>Query()</code> method on the request&rsquo;s <code>URL</code> field. <code>Query()</code> returns a <code>Values</code> type, which is essenitally a map that holds all the query parameter key-value pairs. The <code>Values</code> type has the <code>Get()</code> method that returns a <code>string</code> value associated with the <code>key</code> provided to <code>Get()</code>.</p><h2 id=responses>Responses</h2><p>Responses are made with the <code>http.ResponseWriter</code> interface, which is usually represented with a <code>w</code>.</p><p>It is common to use <code>fmt.Fprintf()</code> to write a response:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Display a specific snippet with ID %d...&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><dl><dt><em>http.Error(writer, error message, status code)</em></dt><dd>Writes an error message on the writer. You can use helper methods like <code>http.StatusText</code>. For example:</dd></dl><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusText</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusInternalServerError</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusInternalServerError</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><dl><dt><em>http.NotFound(w, r)</em></dt><dd>Replies with a <code>404 Not Found</code> status code.</dd></dl><h3 id=headers>Headers</h3><p>Go provides the following headers automatically:</p><ul><li><code>Date</code></li><li><code>Content-Length</code></li><li><code>Content-Type</code> (see w.Header().Set())</li></ul><dl><dt><em>w.Header().Set(<code>header-name</code>, <code>header-value</code>)</em></dt><dd>Adds a custom header to the HTTP response in the <code>header-name</code>:<code>header-value</code> format. A common example is setting the <code>Content-Type</code> header when you send JSON data:</dd></dl><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Content-Type&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;application/json&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>You must write the <code>w.Header().Set()</code>method before <code>w.WriteHeader()</code> or <code>w.Write()</code>.</p><dl><dt><em>w.WriteHeader(<code>status-code</code>)</em></dt><dd>Writes a status code to the response. You should call this method only once.<p>If you do not call this method before <code>w.Write([]bytes())</code>, then the <code>Write</code> method returns a <code>200 OK</code> status code automatically.</p><p><code>w.WriteHeader</code> is not commonly used. You usually pass the writer (<code>w</code>) value to an <code>http</code> package helper function.</p></dd></dl><h3 id=constants>Constants</h3><p>The <code>http</code> package provides <a href=https://pkg.go.dev/net/http#pkg-constants>constants</a> for request methods and status code. These constants improve readability and reduce runtime errors that result from typos. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>snippetCreate</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Method</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodPost</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Allow&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodPost</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Method Not Allowed&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusMethodNotAllowed</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Write</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87>byte</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Create a new snippet...&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=routers>Routers</h2><p>You can create a router with Go&rsquo;s standard library or a 3rd party package.</p><h3 id=go-router>Go router</h3><blockquote><p>The Go standard library does not support naed parameters in URLs, so you might consider a 3rd-party solution for servers with complex routes.</p></blockquote><p>By default, Go supports two types of URL patterns:</p><dl><dt><em>fixed path <code>/path/endpoint</code></em></dt><dd>A fixed path does not have a trailing slash (<code>/</code>). A request must match a fixed path exactly.</dd><dt><em>subtree path <code>/path/bucket/</code></em></dt><dd>A subtree path has a trailing slash. A request must match only the start of the subtree path. Think of subtree paths with a wildcard appended. For example, <code>/path/bucket/*</code>.</dd></dl><p>Create a Go router with these components:</p><ul><li><code>http.Handler</code> type to satisfy the server&rsquo;s <code>Handler</code> field.</li><li><code>Server</code> struct that wraps the <code>http.Handler</code> type.</li><li>Constructor that returns an instance of the struct that wraps the new type.</li><li>A method on the <code>Server</code> that registers routes.</li><li>One or more constants that define the routes.</li></ul><p>The following example creates all required components:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>	<span style=color:#000>shorteningRoute</span>  <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/s&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>resolveRoute</span>     <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/r/&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#000>healthCheckRoute</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/health&#34;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// mux is an unexported http.Handler
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>mux</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Server is a custom server type.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Server</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span> <span style=color:#8f5902;font-style:italic>// the server only exports ServeHTTP
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// NewServer returns an instance of the custom Server type.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>()</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>Server</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>s</span> <span style=color:#000>Server</span>
</span></span><span style=display:flex><span>	<span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>registerRoutes</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>s</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>s</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>registerRoutes</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServeMux</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>shorteningRoute</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>httpio</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>shorteningHandler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>resolveRoute</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>httpio</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>resolveHandler</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandleFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>healthCheckRoute</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>healthCheckHandler</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>mux</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>mux</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=3rd-party-router>3rd-party router</h3><p>This example uses the <a href=https://github.com/julienschmidt/httprouter>julienschmidt</a> router. This router has a few advantages over the Go standard library router:</p><ul><li>Supports named parameters.</li><li>Validates routes. For example, this router matches the home path (<code>"/"</code>) path exactly, so no need for manual checks.</li><li>Easily create <code>404</code> error handlers.</li></ul><p>To create a router, use the <code>New()</code> method. You can register handlers with the <code>Handler()</code> or <code>HandlerFunc()</code> method:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>router</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>httprouter</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>New</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#000>router</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/snippet/view/:id&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>snippetView</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p><code>:id</code> is a named parameter&ndash;it acts as a wildcard for the path segment that it represents.</p><blockquote><p>Always use the <a href=https://pkg.go.dev/net/http#pkg-constants>HTTP method constants</a> when you register a route.</p></blockquote><p>You can also use a parameter that matches everything, which is useful when registering static files:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>fileServer</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>FileServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Dir</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;./ui/static/&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#000>router</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/static/*filepath&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StripPrefix</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/static&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fileServer</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><h4 id=404-handler>404 handler</h4><p>The <code>router.NotFound</code> handler is called when no matching route is found. You can assign it an <code>http.HandlerFunc(func{w, r})</code> to handle <code>404</code> responses:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>router</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NotFound</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>notFound</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span>
</span></span></code></pre></div><h4 id=middleware-and-router-return>Middleware and router return</h4><p>Use <code>alice.New()</code> to chain middleware in a reader-friendly format:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>standard</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>alice</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>New</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>recoverPanic</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logRequest</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>secureHeaders</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Next, return the router:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>standard</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Then</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>router</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h3 id=placeholder-routers>Placeholder routers</h3><p>When you create a router, it is a good practice to register placeholder handlers that return dummy plaintext responses. This helps you set up the routing infrastructure while managing the business logic at a later time.</p><p>In your handlers file, add the placeholder routes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>userSignup</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintln</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Display an HTML form for signing up a new user&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>userSignupPost</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintln</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Create a new user...&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>...</span>
</span></span></code></pre></div><p>In your routes file (where you register your routes), register the routes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>	<span style=color:#000>router</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>httprouter</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>New</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>router</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/user/signup&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>dynamic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ThenFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>userSignup</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#000>router</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodPost</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;/user/signup&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>dynamic</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Then</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>userSignupPost</span><span style=color:#000;font-weight:700>()))</span>
</span></span></code></pre></div><h2 id=writing-a-basic-server>Writing a basic server</h2><p>There are two important concepts that are central to creating a custom server in Go:</p><ul><li><code>Server</code> type: listens for client connections and routes incoming requests in a goroutine to a type that implements the <code>Handler</code> interface.</li><li><code>Handler</code> interface: contains one method, <code>ServeHTTP(ResponseWriter, *Request)</code>.</li></ul><p>You can create a server with any type as long as it implements <code>Handler</code> interface. A server should have the following:</p><ul><li>One or more registered routes with an associated function to handle requests to that route.</li><li>A server multiplexer that can manage multiple registered routes.</li></ul><h3 id=directory-structure>Directory structure</h3><p>A suggested server directory structure:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── cmd
</span></span><span style=display:flex><span>│   └── server
</span></span><span style=display:flex><span>│       └── server.go
</span></span><span style=display:flex><span>├── internal
</span></span><span style=display:flex><span>│   └── helpers
</span></span><span style=display:flex><span>│       ├── handler.go
</span></span><span style=display:flex><span>│       └── helpers.go
</span></span><span style=display:flex><span>├── errors
</span></span><span style=display:flex><span>│   └── errors.go
</span></span><span style=display:flex><span>└── service-name
</span></span><span style=display:flex><span>    ├── server.go
</span></span><span style=display:flex><span>    ├── server_test.go
</span></span><span style=display:flex><span>    └── service.go
</span></span></code></pre></div><p>In the preceding example:</p><ul><li><code>cmd/serverdir/server.go</code> contains the <code>main</code> method. This is where you create a logger and execute the server&rsquo;s <code>ListenAndServe()</code> method.</li><li><code>internal/helpers/*</code> contains private code such as JSON formatters and handlers for the handler chaining pattern.</li><li><code>errors/errors.go</code> contains custom errors.</li><li><code>server-name/server.go</code> contains the service&rsquo;s server implementation, including the constructor, routes, etc.</li><li><code>service-name/server_test.go</code> tests <code>server.go</code> with the <code>httptest.NewRecorder()</code> method.</li><li><code>server-name/service.go</code> contains the service&rsquo;s business logic.</li></ul><h3 id=define-the-custom-server-type>Define the custom Server type</h3><p>In the project root, create a subdirectory and file called <code>json-server/server.go</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir json-server
</span></span><span style=display:flex><span>touch json-server/server.go
</span></span></code></pre></div><p>The <code>Server</code> type must implement the <code>Handler</code> interface, so embed the <code>Handler</code> interface in the Server type:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>mux</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>Server</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Interface embedding elevates the interface methods to the containing type, so the <code>Server</code> implements the <code>Handler</code>&rsquo;s <code>ServeHTTP</code> method.</p><h3 id=create-the-main-method>Create the main method</h3><ol><li><p>In the project root, create the main <code>server.go</code> file:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p cmd/server/server.go
</span></span></code></pre></div></li><li><p>In the <code>main</code> method, define the <code>address</code> that the server listens on in <code>host:port</code> format. If you provide only the <code>port</code>, then the server listens on all available network interfaces. This means that <code>host</code> is important only if your machine has multiple network interfaces.</p><p>Additionally, define a <code>timeout</code> duration. The <code>timeout</code> makes the server return after <code>timeout</code> seconds if the response is not complete:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000;font-weight:700>(</span>
</span></span><span style=display:flex><span>    <span style=color:#000>addr</span>    <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;localhost:8080&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>timeout</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><blockquote><p>In some circumstances, you will see <code>:http</code> or <code>:http-alt</code> in place of a port number. This means the server looks up the port number in the <code>etc/services</code> file.</p></blockquote></li><li><p>Create a new multiplexer server:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServer</span><span style=color:#000;font-weight:700>()</span>
</span></span></code></pre></div></li><li><p>Create the server. Assign the <code>address</code> and <code>timeout</code> variables. For <code>Handler</code>, use <code>TimeoutHandler</code> so you can assign the timeout value:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>server</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>        <span style=color:#000>addr</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Handler</span><span style=color:#000;font-weight:700>:</span>     <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>TimeoutHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>server</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>timeout</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;timeout&#34;</span><span style=color:#000;font-weight:700>),</span> <span style=color:#8f5902;font-style:italic>// runs server for timeout seconds
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>ReadTimeout</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>timeout</span><span style=color:#000;font-weight:700>,</span> <span style=color:#8f5902;font-style:italic>// max time for reading the entire request
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></li><li><p>Start the server. The normal behavior for stopping a server returns the <code>http.ErrServerClosed</code> error, so check for that error and return a message:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>server</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ListenAndServe</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000;font-weight:700>!</span><span style=color:#000>errors</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Is</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ErrServerClosed</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintln</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;server closed unexpectedly:&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>   
</span></span></code></pre></div></li></ol><h4 id=example-2>Example 2</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>customServer</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>         <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Sprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s:%d&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>host</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>port</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>Handler</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#000>MuxFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>    <span style=color:#000>ReadTimeout</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000>WriteTimeout</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Start the server with <code>ListenAndServe</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ListenAndServe</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintln</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Exit</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=timeouts>Timeouts</h2><p>Add timeouts to the server instance. The following timeouts apply to all requests:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>srv</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#000>IdleTimeout</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Minute</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	<span style=color:#000>ReadTimeout</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	<span style=color:#000>WriteTimeout</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>In the preceding configuration:</p><ul><li><p><code>IdleTimeout</code> closes all keep-alive connections after one minute. A keep-alive is HTTP connection reuse, where a single TCP connection is used to send and receive multiple HTTP requests and responses rather than opening new connections.</p><p>Always set an <code>IdleTimeout</code> for the server.</p></li><li><p><code>ReadTimeout</code> sets the amount of time that the request headers and body are read after the request is first accepted. If the read operation exceeds the setting, the connection is closed.</p><p>By default, <code>IdleTimeout</code> uses the same setting as <code>ReadTimout</code> if it is not explicitly set. Again&ndash;always set <code>IdleTimeout</code> on the server.</p></li><li><p><code>WriteTimeout</code> closes the connection if the server tries to write to the connection after the set length. This setting&rsquo;s timeout period behavior depends upon the protocol:</p><ul><li>HTTP: Times out <em>setting seconds</em> after the request header is read.</li><li>HTTPS: Times out <em>setting seconds</em> after the request is accepted.</li></ul><blockquote><p>This setting does not impact long-running handlers&ndash;it impacts how long the handler writes from its buffer to the connection when it returns.</p></blockquote></li></ul><h2 id=static-files>Static files</h2><p>To server static files (files that the server does not process), you have to create a <code>Handler</code> with the <code>FileServer()</code> function. The <code>FileServer()</code> handler serves HTTP requests with the files stored in the path that you pass as a function argument:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>staticFiles</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>FileServer</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Dir</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/public&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>When you register the file server handle, you have to strip the path pattern from the request URL, or the server attempts to serve files from an invalid path and returns a 404:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>mux</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/static&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StripPrefix</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/static&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>staticFiles</span><span style=color:#000;font-weight:700>))</span>
</span></span></code></pre></div><p>The preceding examples create a <code>Handler</code> named <code>staticFiles</code> that serves HTTP requests with the contents of the <code>/public</code> directory. When you register the <code>staticFiles</code>, you are telling the multiplexer that when there is a request to the <code>/static</code> path, strip <code>/static</code> from the request URL, and then search the <code>/public</code> directory for a file that matches the request.</p><h3 id=directory-listings>Directory listings</h3><p>After you create a file server, users can access the static files in a browser by going to <code>/static/path/to/assets/</code>. To disable this, create a blank <code>index.html</code> file in each subdirectory in the <code>/static/</code> directory.</p><h2 id=middleware>Middleware</h2><blockquote><p>The following sections detail how to create, register, and chain middlewares with Go&rsquo;s standard library. You can use the <a href=https://github.com/justinas/alice>justinas/alice</a> package to simplify middleware code.</p></blockquote><p>Middleware is code that executes on a request before or after your handlers. It is functionality that you want to share among your HTTP request handlers. For example:</p><ul><li>Logging</li><li>Response compression</li><li>Serving files from a cache</li></ul><p>You chain middleware. After one middleware function executes, it calls the <code>ServeHTTP()</code> method on the next handler until a response returns.</p><p>Middleware uses the following pattern:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>myMiddleware</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>next</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fn</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// TODO: Execute our middleware logic here...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>next</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServeHTTP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fn</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The pattern does the following:</p><ul><li><code>myMiddleware</code> wraps the <code>next</code> handler that you pass as an argument.</li><li><code>fn</code> is a closure that has access to any values in the <code>next</code> handler&rsquo;s scope. It returns <code>next.ServerHTTP()</code>.</li><li><code>myMiddleware</code> converts the closure to a handler and returns.</li></ul><p>This pattern can be simplified as follows:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>myMiddleware</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>next</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// TODO: Execute our middleware logic here...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>next</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServeHTTP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=positioning>Positioning</h3><p>If you want the middleware to execute on all requests, place it before the server mux:</p><pre tabindex=0><code>myMiddleware -&gt; mux -&gt; handler
</code></pre><p>If you want the middleware to execute on a specific request, place it after the server mux, but before the request handler:</p><pre tabindex=0><code>mux -&gt; myMiddleware -&gt; handler
</code></pre><h3 id=security-headers>Security headers</h3><p>Create a new <code>/cmd/web/middleware.go</code> file and add a middleware function that adds secure headers to each request. These headers satisfy <a href=https://owasp.org/www-project-secure-headers/>OWASP standards</a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>secureHeaders</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>next</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Content-Security-Policy&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;default-src &#39;self&#39;; style-src &#39;self&#39; fonts.googleapis.com; font-src fonts.gstatic.com&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Referrer-Policy&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;origin-when-cross-origin&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;X-Content-Type-Options&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;nosniff&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;X-Frame-Options&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;deny&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;X-XSS-Protections&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;0&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>next</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServeHTTP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The previous example adds these headers:</p><ul><li><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP>Content-Security-Policy</a> (CSP) retricts the resources that you site can access.<blockquote><p>During development, CSP headers are a common cause of blocked resource loads.</p></blockquote></li><li><a href=https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy>Referrer-Policy</a> includes the site URL in a <code>Referrer</code> header when users navigate away from your site.</li><li><a href=https://security.stackexchange.com/questions/7506/using-file-extension-and-mime-type-as-output-by-file-i-b-combination-to-dete/7531#7531>X-Content-Type-Options: nosniff</a> prevents content-sniffing attacks.</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/Security/Types_of_attacks#click-jacking>X-Frame-Options: deny</a> prevents clickjacking in old browsers that do not support CSP.</li><li><a href=https://owasp.org/www-project-secure-headers/#x-xss-protection>X-XSS-Protection: 0</a> disables blocking of cross-site scripting attacks because we are using CSP headers.</li></ul><h3 id=request-logging>Request logging</h3><p>Log all requests before they are dispatched to a handler:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>logRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>next</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>infoLog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s - %s %s %s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RemoteAddr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Proto</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Method</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>URL</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestURI</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>next</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServeHTTP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The preceding middleware is added as a method on the application so that it can access the application dependencies, like the <code>infoLog</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>application</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>	<span style=color:#000>infoLog</span>       <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Logger</span>
</span></span><span style=display:flex><span>	<span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=register-middleware>Register middleware</h3><p>If your middleware needs to execute on all routes, register it where you register routes. This example returns the <a href=#security-headers>security middleware</a> from the <a href=#request-logging>logging middleware</a>, and the security middleware returns the <code>mux</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// return a handler
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>routes</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServeMux</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// register routes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>secureHeaders</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>mux</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><blockquote><p>Think of the <code>mux</code> as the main handler that you are returning&ndash;it is the handler registered to your server struct in <code>main</code>&ndash;so the other handlers enclose it.</p></blockquote><h3 id=panics>Panics</h3><p>If there is a panic in a handler, the panic is isolated in the goroutine that runs the handler, so your application does not stop. However, you should handle panics to provide a good user experience.</p><p>The following middleware handles panics in a handler goroutine. It recovers from the panic, then sets a <code>Connection: close</code> header so the server closes the panicked connection.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>recoverPanic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>next</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Create a deferred function (which will always be run in the event
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// of a panic as Go unwinds the stack).
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#8f5902;font-style:italic>// Use the builtin recover function to check if there has been a
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#8f5902;font-style:italic>// panic or not. If there has...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>recover</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic>// Set a &#34;Connection: close&#34; header on the response.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Header</span><span style=color:#000;font-weight:700>().</span><span style=color:#000>Set</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Connection&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;close&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>                <span style=color:#8f5902;font-style:italic>// Call the app.serverError helper method to return a 500
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#8f5902;font-style:italic>// Internal Server response.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>                <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>serverError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>next</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ServeHTTP</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Add this handler to the beginning of the middleware chain so that it recovers from any panic that occurs in any handler:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>routes</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>mux</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServeMux</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#8f5902;font-style:italic>// register routes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>recoverPanic</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logRequest</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>secureHeaders</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>mux</span><span style=color:#000;font-weight:700>)))</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>The previous panic handlers recover only when the panic occurs in the same goroutine that runs the handler. If your handler spins off another goroutine that might panic, you can add the following anonymous function to do the work and handle the possible panic:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>myHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ce5c00;font-weight:700>...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Spin up a new goroutine to do some background processing.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>go</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>recover</span><span style=color:#000;font-weight:700>();</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>                <span style=color:#000>log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Print</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Errorf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s\n%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>debug</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Stack</span><span style=color:#000;font-weight:700>()))</span>
</span></span><span style=display:flex><span>            <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>doSomeBackgroundProcessing</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>w</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Write</span><span style=color:#000;font-weight:700>([]</span><span style=color:#204a87>byte</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;OK&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=forms>Forms</h2><p>Parse a form with the Request&rsquo;s <code>.ParseForm()</code> method. This method stores data from the form in the requests <code>PostForm</code> field as a map of <code>Values</code>. In addition, the Request type has a <code>Form</code> field. The two have the following differences:</p><ul><li><code>PostForm</code> is populated for only <code>POST</code>, <code>PATCH</code>, and <code>PUT</code> requests.</li><li><code>Form</code> is populated for all requests, including query string parameters. Use the <code>Get()</code> method to access query string parameters.</li></ul><p>The <code>name</code> attribute of each HTML form element is the key in the map, and you access the value with the <code>.Get()</code> method. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>To get the value of this input, use the following:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#000>title</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PostForm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>Consider the following form:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>form</span> <span style=color:#c4a000>action</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/snippet/create&#34;</span> <span style=color:#c4a000>method</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;post&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>Title:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;text&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>Content:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>textarea</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>&gt;&lt;/</span><span style=color:#204a87;font-weight:700>textarea</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>Delete in:<span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>label</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;radio&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;expires&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;365&#34;</span> <span style=color:#c4a000>checked</span><span style=color:#000;font-weight:700>&gt;</span> One Year
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;radio&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;expires&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;7&#34;</span><span style=color:#000;font-weight:700>&gt;</span> One Week
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;radio&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;expires&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;1&#34;</span><span style=color:#000;font-weight:700>&gt;</span> One Day
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;submit&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;Publish snippet&#34;</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>div</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;/</span><span style=color:#204a87;font-weight:700>form</span><span style=color:#000;font-weight:700>&gt;</span>
</span></span></code></pre></div><p>The following method parses the form, extracts its values with error checking, then inserts the values in a table. At the end, it redirects the request to a new path with <code>Redirect()</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>snippetCreateForm</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Title</span>   <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Content</span> <span style=color:#204a87;font-weight:700>string</span>
</span></span><span style=display:flex><span>	<span style=color:#000>Expires</span> <span style=color:#204a87;font-weight:700>int</span>
</span></span><span style=display:flex><span>	<span style=color:#000>validator</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Validator</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>snippetCreatePost</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// First we call r.ParseForm() which adds any data in POST request bodies
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// to the r.PostForm map. This also works in the same way for PUT and PATCH
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// requests. If there are any errors, we use our app.ClientError() helper to 
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// send a 400 Bad Request response to the user.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ParseForm</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>clientError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusBadRequest</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// The r.PostForm.Get() method always returns the form data as a *string*.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// However, we&#39;re expecting our expires value to be a number, and want to
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// represent it in our Go code as an integer. So we need to manually covert
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// the form data to an integer using strconv.Atoi(), and we send a 400 Bad
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// Request response if the conversion fails.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>expires</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>strconv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Atoi</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PostForm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;expires&#34;</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>clientError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusBadRequest</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8f5902;font-style:italic>// Use the r.PostForm.Get() method to retrieve the title and content
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// from the r.PostForm map.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>	<span style=color:#000>form</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>snippetCreateForm</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Title</span><span style=color:#000;font-weight:700>:</span>   <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PostForm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Content</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PostForm</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>		<span style=color:#000>Expires</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>expires</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CheckField</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validator</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NotBlank</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Title</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;This field cannot be blank&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CheckField</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validator</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MaxChars</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Title</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>100</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#34;title&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;This field cannot be more than 100 characters long&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CheckField</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validator</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NotBlank</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#34;content&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;This field cannot be blank&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>CheckField</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>validator</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PermittedInt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Expires</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>365</span><span style=color:#000;font-weight:700>),</span> <span style=color:#4e9a06>&#34;expires&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;This field must equal 1, 7 or 365&#34;</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>!</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Valid</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>data</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newTemplateData</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Form</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>form</span>
</span></span><span style=display:flex><span>		<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>render</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusUnprocessableEntity</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;create.tmpl.html&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>snippets</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Insert</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Title</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Content</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>form</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Expires</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>serverError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Redirect</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Sprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/snippet/view/%d&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusSeeOther</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If a form field sends multiple values, you have to loop through the <code>PostForm</code>. For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;items&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;foo&#34;</span><span style=color:#000;font-weight:700>&gt;</span> Foo
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;items&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;bar&#34;</span><span style=color:#000;font-weight:700>&gt;</span> Bar
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>&lt;</span><span style=color:#204a87;font-weight:700>input</span> <span style=color:#c4a000>type</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;checkbox&#34;</span> <span style=color:#c4a000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;items&#34;</span> <span style=color:#c4a000>value</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;baz&#34;</span><span style=color:#000;font-weight:700>&gt;</span> Baz
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>item</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87;font-weight:700>range</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PostForm</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#34;items&#34;</span><span style=color:#000;font-weight:700>]</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;%d: Item %s\n&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>i</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>item</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p><code>ParseForm</code> cannot parse request bodies that exceed 10MB, or it returns an error. You can change this amount using <code>MaxBytesReader()</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Limit the request body size to 4096 bytes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Body</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MaxBytesReader</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Body</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4096</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ParseForm</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;Bad Request&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusBadRequest</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>When the limit is reached, the server closes the underlying TCP connection.</p><h3 id=validation>Validation</h3><p>See <a href=https://www.alexedwards.net/blog/validation-snippets-for-go>Validation Snippets for Go</a> for field validation patterns.</p><p>Validate form values with standard <code>if</code> clauses and your validation criteria for best practices. A useful pattern is to create a map, and store the field and a discription of any invalid data in the map:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Initialize a map to hold any validation errors for the form fields.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>fieldErrors</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>make</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// validate fields
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// If there are any errors, dump them in a plain text HTTP response and
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#8f5902;font-style:italic>// return from the handler.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>if</span> <span style=color:#204a87>len</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>fieldErrors</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Fprint</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>fieldErrors</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=sessions>Sessions</h2><p>Create a session with the <a href=https://github.com/alexedwards/scs>scs package</a> with the following steps:</p><p>First, create a table to store the session data.</p><p>In the <code>main</code> method:</p><ol><li>Add the session manager to the application struct.</li><li>Create the session manager with <code>New()</code>.</li><li>Configure the new session manager to use the database.</li><li>Set a lifetime on the session manager.</li></ol><p>In <code>routes.go</code>:
5. Create a new middleware chain.
6. Update any routes with the middleware chain.</p><p>In the relevant handlers:</p><ol><li>Add the message or busniess logic into the session context.</li></ol><p>In the <code>newTemplateData</code> helper method:</p><ol><li>Add a field that makes the business logic available to the application when it is present.</li></ol><p>In <code>templates.go</code>:</p><ol><li>Add a field to the <code>templateData</code> struct that stores the data that you want to pass to the template.</li></ol><p>Update the template to display the dynamic data from <code>templateData</code>.</p><p>Now, the <code>LoadAndSave()</code> middleware checks each incoming request for a cookie. If a cookie is present, it does the following:</p><ol><li>Reads the token</li><li>Uses the token to retrieve session data from the database</li><li>Adds the session data to the request context so the handlers can use it.</li></ol><p>Any changes to session data are updated in the handler request context, and then the middleware updates the changes when it returns.</p><h2 id=shutdown-gracefully>Shutdown gracefully</h2><p>You might have concurrent code that is still running when your server fails, and you need to make sure that the process completes before the server stops. You can add a WaitGroup to the application struct, and wait until all goroutines complete before you shut down the server.</p><p>Add the WaitGroup to the application struct:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cmd/api/main.go
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>type</span> <span style=color:#000>application</span> <span style=color:#204a87;font-weight:700>struct</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>config</span> <span style=color:#000>config</span>
</span></span><span style=display:flex><span>    <span style=color:#000>logger</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>jsonlog</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Logger</span>
</span></span><span style=display:flex><span>    <span style=color:#000>models</span> <span style=color:#000>data</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Models</span>
</span></span><span style=display:flex><span>    <span style=color:#000>mailer</span> <span style=color:#000>mailer</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Mailer</span>
</span></span><span style=display:flex><span>    <span style=color:#000>wg</span>     <span style=color:#000>sync</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WaitGroup</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Wait for all goroutines to complete before you shutdown the server:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// cmd/api/server.go
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>app</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>application</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>serve</span><span style=color:#000;font-weight:700>()</span> <span style=color:#204a87;font-weight:700>error</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>    <span style=color:#000>srv</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Server</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Addr</span><span style=color:#000;font-weight:700>:</span>         <span style=color:#000>fmt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Sprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;:%d&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>port</span><span style=color:#000;font-weight:700>),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>Handler</span><span style=color:#000;font-weight:700>:</span>      <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>routes</span><span style=color:#000;font-weight:700>(),</span>
</span></span><span style=display:flex><span>        <span style=color:#000>IdleTimeout</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Minute</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>ReadTimeout</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#0000cf;font-weight:700>5</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000>WriteTimeout</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>10</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>shutdownError</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>make</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>chan</span> <span style=color:#204a87;font-weight:700>error</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>go</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>()</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#000>quit</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>make</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>chan</span> <span style=color:#000>os</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Signal</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>signal</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Notify</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>quit</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>syscall</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SIGINT</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>syscall</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>SIGTERM</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#000>s</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&lt;-</span><span style=color:#000>quit</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PrintInfo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;caught signal&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#4e9a06>&#34;signal&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>s</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(),</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>ctx</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>cancel</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>WithTimeout</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Background</span><span style=color:#000;font-weight:700>(),</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>time</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Second</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>cancel</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Call Shutdown() on the server like before, but now we only send on the
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// shutdownError channel if it returns an error.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>srv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Shutdown</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#000>shutdownError</span> <span style=color:#ce5c00;font-weight:700>&lt;-</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Log a message to say that we&#39;re waiting for any background goroutines to
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// complete their tasks.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PrintInfo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;completing background tasks&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>            <span style=color:#4e9a06>&#34;addr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>srv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Addr</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8f5902;font-style:italic>// Call Wait() to block until our WaitGroup counter is zero --- essentially
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// blocking until the background goroutines have finished. Then we return nil on
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// the shutdownError channel, to indicate that the shutdown completed without
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#8f5902;font-style:italic>// any issues.
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>wg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Wait</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>        <span style=color:#000>shutdownError</span> <span style=color:#ce5c00;font-weight:700>&lt;-</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PrintInfo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;starting server&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;addr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>srv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Addr</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;env&#34;</span><span style=color:#000;font-weight:700>:</span>  <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>config</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>env</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>srv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ListenAndServe</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>!</span><span style=color:#000>errors</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Is</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ErrServerClosed</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#ce5c00;font-weight:700>&lt;-</span><span style=color:#000>shutdownError</span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>err</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>logger</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>PrintInfo</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;stopped server&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;addr&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#000>srv</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Addr</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>nil</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h2 id=existing-docs>Existing docs</h2><p>Implement the fields that you need when you define a custom server:</p><h3 id=multiplexers>Multiplexers</h3><p>A multiplexer maps incoming requests to the proper handler functions using the request URL. <code>net/http</code> provides the DefaultServeMux function that returns the default multiplexer, but you should define a custom multiplexer for the following reasons:</p><ul><li>The default registers routes globally.</li><li>You can add dependencies to the routes.</li><li>Custom multiplexers allow integration testing</li></ul><h3 id=router-functions>Router functions</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>todoRouter</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>todoFile</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>l</span> <span style=color:#000>sync</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Locker</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandlerFunc</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>func</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>ResponseWriter</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Request</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#000>list</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>todo</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>List</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>l</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Lock</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>defer</span> <span style=color:#000>l</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Unlock</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>);</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#000>replyError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusInternalServerError</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>URL</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Path</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#34;&#34;</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Method</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>				<span style=color:#000>getAllHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodPost</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>				<span style=color:#000>addHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>default</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>				<span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;Method not supported&#34;</span>
</span></span><span style=display:flex><span>				<span style=color:#000>replyError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusMethodNotAllowed</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>validateID</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>URL</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Path</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>errors</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Is</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>err</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ErrNotFound</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>				<span style=color:#000>replyError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusNotFound</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>				<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>			<span style=color:#000>replyError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusBadRequest</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
</span></span><span style=display:flex><span>			<span style=color:#204a87;font-weight:700>return</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Method</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodGet</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>			<span style=color:#000>getOneHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodDelete</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>			<span style=color:#000>deleteHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>case</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>MethodPatch</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>			<span style=color:#000>patchHandler</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>list</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#204a87;font-weight:700>default</span><span style=color:#000;font-weight:700>:</span>
</span></span><span style=display:flex><span>			<span style=color:#000>message</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#4e9a06>&#34;Method not supported&#34;</span>
</span></span><span style=display:flex><span>			<span style=color:#000>replyError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>w</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StatusMethodNotAllowed</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>message</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Multiplexer definition:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>newMux</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>todoFile</span> <span style=color:#204a87;font-weight:700>string</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handler</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>	<span style=color:#000>m</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>NewServeMux</span><span style=color:#000;font-weight:700>()</span>
</span></span><span style=display:flex><span>	<span style=color:#000>mu</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>sync</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Mutex</span><span style=color:#000;font-weight:700>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HandleFunc</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>rootHandler</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>t</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#000>todoRouter</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>todoFile</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>mu</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/todo&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StripPrefix</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/todo&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>t</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>	<span style=color:#000>m</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Handle</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/todo/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>StripPrefix</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;/todo/&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>t</span><span style=color:#000;font-weight:700>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>m</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 The Docsy Authors All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=/js/main.min.be25a680a0d95dc8b5d6664622e2134aa894220e2f224ef609e00f633a3a1b32.js integrity="sha256-viWmgKDZXci11mZGIuITSqiUIg4vIk72CeAPYzo6GzI=" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script></body></html>